(this.webpackJsonpmqttreact=this.webpackJsonpmqttreact||[]).push([[0],{117:function(e,t,n){e.exports=n(242)},122:function(e,t,n){},123:function(e,t,n){},128:function(e,t){},130:function(e,t){},166:function(e,t){},167:function(e,t){},242:function(e,t,n){"use strict";n.r(t);var o=n(0),c=n.n(o),i=n(20),a=n.n(i),l=(n(122),n(123),n(244)),r=n(45),s=n(44),u=n(23),m=n(55),d=n.n(m),p=n(246),h=function(e){var t=e.url,n=e.mqttOptions,i=Object(o.useState)(null),a=Object(u.a)(i,2),r=a[0],m=a[1],h=Object(o.useState)("Disconnected"),g=Object(u.a)(h,2),f=g[0],b=g[1],v=Object(o.useState)(""),E=Object(u.a)(v,2),O=E[0],T=E[1],j=Object(o.useState)(""),S=Object(u.a)(j,2),q=S[0],k=S[1],C=e.temperatureTopic,w=e.lightTopic,M={topic:C,payload:"Something went wrong with Hall",qos:2,retain:!1};Object(o.useEffect)((function(){r&&(console.log(r),r.on("connect",(function(){D(),b("Connected")})),r.on("error",(function(e){console.error("Connection error: ",e),r.end((function(){b("Disconnected")}))})),r.on("reconnect",(function(){b("Reconnecting")})))}),[r]);var B=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1)+e)},D=function(){P(),setTimeout(N,2e3)},N=function e(){if(r){var t=B(20,45).toString();r.publish(C,t,{qos:2},(function(e){T({lightTopic:w,message:t}),e&&console.log("Temp Publish error: ",e)})),setTimeout(e,4e3)}},P=function e(){if(r){var t=B(100,200).toString();r.publish(w,t,{qos:2},(function(e){k({lightTopic:w,message:t}),e&&console.log("Publish error: ",e)})),setTimeout(e,4e3)}};return c.a.createElement(l.a,{className:"equal-width",title:e.title},c.a.createElement("div",null,"Topic:",e.temperatureTopic,",",c.a.createElement("div",null,e.lightTopic)),c.a.createElement("div",null,"Temp: ",(null===O||void 0===O?void 0:O.message)||0),c.a.createElement("div",null,"Light: ",(null===q||void 0===q?void 0:q.message)||0),c.a.createElement("div",null,"Status: ",f),"Connected"===f?c.a.createElement(p.a,{onClick:function(){console.log("disconnectToBroker"),r&&r.end((function(){b("Disconnected")}))}},"Disconnect"):c.a.createElement(p.a,{onClick:function(){console.log("connectToBroker");var e=Object(s.a)(Object(s.a)({},n),{},{clientId:"mqttjs_ + ".concat(Math.random().toString(16).substr(2,8)),will:M});m(d.a.connect(t,e))}},"Connect"))},g=function(e){var t=e.url,n=e.mqttOptions,i=Object(o.useState)(null),a=Object(u.a)(i,2),r=a[0],m=a[1],h=Object(o.useState)("Connect"),g=Object(u.a)(h,2),f=g[0],b=g[1],v=Object(o.useState)(""),E=Object(u.a)(v,2),O=E[0],T=E[1],j=Object(o.useState)(""),S=Object(u.a)(j,2),q=S[0],k=S[1],C={topic:"home/hall/temp",payload:"Something went wrong with ".concat(e.title),qos:2,retain:!1};Object(o.useEffect)((function(){r&&(console.log(r),r.on("connect",(function(){b("Connected")})),r.on("error",(function(e){console.error("Connection error: ",e),r.end((function(){b("Connect")}))})),r.on("reconnect",(function(){b("Reconnecting")})),r.subscribe(e.topic,{qos:1}),r.on("message",(function(e,t){var n={topic:e,message:t.toString()};console.log(e),"temp"==e.split("/")[2]?T(n):"light"==e.split("/")[2]&&k(n),console.log("Recieved",e,t.toString())})))}),[r]);return c.a.createElement(l.a,{className:"equal-width",title:e.title},c.a.createElement("div",null,"Topic: ",e.topic),c.a.createElement("div",null,"Temp: ",null===O||void 0===O?void 0:O.message),c.a.createElement("div",null,"Light: ",null===q||void 0===q?void 0:q.message),c.a.createElement("div",null,"Status: ",f),"Connected"===f?c.a.createElement(p.a,{onClick:function(){console.log("disconnectToBroker"),r&&r.end((function(){b("Disconnected")}))}},"Disconnect"):c.a.createElement(p.a,{onClick:function(){console.log("connectToBroker");var e=Object(s.a)(Object(s.a)({},n),{},{clientId:"mqttjs_ + ".concat(Math.random().toString(16).substr(2,8)),will:C});m(d.a.connect(t,e))}},"Connect"))},f={keepalive:30,protocolId:"MQTT",protocolVersion:4,clean:!0,reconnectPeriod:1e3,connectTimeout:3e4,rejectUnauthorized:!1},b=function(){var e="ws://".concat("broker.mqttdashboard.com",":").concat(8e3,"/mqtt");return c.a.createElement(l.a,{title:"MQTT Using React",className:"background-color"},c.a.createElement(r.a,{className:"flex-box"},c.a.createElement("div",{className:"content-align-center first"},c.a.createElement(h,{url:e,mqttOptions:f,retain:!0,temperatureTopic:"home/hall/temp",lightTopic:"home/hall/light",title:"Hall Publisher"}),c.a.createElement(h,{url:e,mqttOptions:f,retain:!0,temperatureTopic:"home/kitchen/temp",lightTopic:"home/kitchen/light",title:"Kitchen Publisher"})),c.a.createElement("div",{className:"content-align-center second"},c.a.createElement(g,{url:e,mqttOptions:f,title:"Subscriber A",topic:"home/hall/#"}),c.a.createElement(g,{url:e,mqttOptions:f,title:"Subscribr B",topic:"home/kitchen/#"}))))};a.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(b,null)),document.getElementById("root"))}},[[117,1,2]]]);
//# sourceMappingURL=main.6b1cd79e.chunk.js.map